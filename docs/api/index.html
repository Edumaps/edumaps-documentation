<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

        <title>API Reference</title>

        <link href="build/app.css" rel="stylesheet" />
        <script src="build/libs.js" type="text/javascript"></script>
        <script src="build/app.js" type="text/javascript"></script>
    </head>

    <body class="index">
        <script type="text/javascript">
            $('body').data('languages', ["bash"]);
        </script>

        <a href="#" id="nav-button">
            <span>
                NAV
                <img src="build/navbar.png"/>
            </span>
        </a>

        <div class="tocify-wrapper">
            <img src="images/logo.png"/>

            <div class="lang-selector">
                    <a href="#" data-language-name="bash">bash</a>
            </div>

                <div class="search">
                    <input type="text" class="search" id="input-search" placeholder="Search">
                </div>

                <ul class="search-results"></ul>

            <div id="toc"></div>

            <ul class="toc-footer">
                    <li><a href='https://edumaps.com#register'>Sign up for an account</a></li>
                    <li>a <a href='http://marketlayer.com'>marketlayer</a> platform</li>
            </ul>
        </div>

        <div class="page-wrapper">
            <div class="dark-box"></div>

            <div class="content">
                <h1 id="introduction">Introduction</h1>
<p>Welcome to the Edumaps API! You can use the API to access Edumaps data, which can get fetch information on various resources within the Edumaps database.</p>
<p>Edumaps API has language bindings in Shell only! The Edumaps API is purely a RESTful api service with external integrations hooked in.</p>
<p>You can view code examples in the dark area to the right.</p>
<h1 id="user">User</h1>
<p>Edumaps API uses <a href="https://jwt.io/">jwt</a> to provide access to user accounts and results from secured endpoints. The user authenticates by providing a username (typically their registered email address) and a password. Upon successful login a token is returned which can then be used for all other endpoint calls.</p>
<h2 id="registration">Registration</h2>
<aside class="endpoint">
        <code>POST</code> /signup
</aside>

<p>The <strong>signup</strong> endpoint allows users to register for access to the Edumaps service.</p>
<p>This includes access to the main application, the API and any other services that may be deployed in future.</p>
<blockquote>
<h3 id="-code-class-response-curl-code-request"><code class="response">CURL</code> Request</h3>
</blockquote>
<pre class="highlight bash"><code><span class="hljs-comment"># This is the call to authenticate a user</span>
curl <span class="hljs-string">"&lt;-- endpoint here --&gt;/auth/local"</span>
        -H <span class="hljs-string">"Accept: application/json"</span>
        -H <span class="hljs-string">"Content-Type: application/json"</span>
        <span class="hljs-_">-d</span> <span class="hljs-string">"email: &lt;-- user's email address --&gt;"</span>
        <span class="hljs-_">-d</span> <span class="hljs-string">"password: &lt;-- user's password --&gt;"</span>
</code></pre>
<aside class="request">Request</aside>

<h3 id="payload-options">Payload Options</h3>
<table>
<thead>
<tr>
<th></th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>email</code></td>
<td><code class="required"></code></td>
<td>Registered user&#39;s email address</td>
</tr>
<tr>
<td><code>password</code></td>
<td><code class="required"></code></td>
<td>Registered user&#39;s password</td>
</tr>
<tr>
<td><code>redirect</code></td>
<td></td>
<td>If provided the acivation link sent to the user will contain a success redirect url that redirects the user to after successful activation</td>
</tr>
</tbody>
</table>
<blockquote>
<h3 id="-code-class-response-201-code-response"><code class="response">201</code> Response</h3>
</blockquote>
<pre class="highlight json"><code>{
        <span class="hljs-attr">"activationEmailSent"</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">"data"</span>: {
                <span class="hljs-attr">"_id"</span>: <span class="hljs-string">"&lt;-- user id --&gt;"</span>,
                <span class="hljs-attr">"username"</span>: <span class="hljs-string">"&lt;-- user email address --&gt;"</span>,
                <span class="hljs-attr">"email"</span>: <span class="hljs-string">"&lt;-- user email address --&gt;"</span>,
                <span class="hljs-attr">"updatedAt"</span>: <span class="hljs-string">"2016-08-05T08:18:51.612Z"</span>,
                <span class="hljs-attr">"createdAt"</span>: <span class="hljs-string">"2016-08-05T08:18:51.612Z"</span>,
                <span class="hljs-attr">"belongsTo"</span>: [... &lt;-- array of organisation domains that user is associated to --&gt;],
                <span class="hljs-attr">"integrations"</span>: [... &lt;-- array of services that user has enabled --&gt;]
                ...
        }
}
</code></pre>
<aside class="response">Response</aside>

<p>An expected successful response should result in a <strong><code>201</code></strong> header response. The JSON response body will contain the following properties (only some are listed).</p>
<h3 id="response-properties">Response Properties</h3>
<table>
<thead>
<tr>
<th></th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>activationEmailSent</code></td>
<td><strong>Boolean</strong></td>
<td>Confirmation that an activation email has been forwarded to the registered user</td>
</tr>
<tr>
<td><code>data._id</code></td>
<td><strong>String</strong></td>
<td>The ID of the newly registered user</td>
</tr>
<tr>
<td><code>data.username</code></td>
<td><strong>String</strong></td>
<td>The username of the user. <strong>This is currently automatically assigned the email address</strong></td>
</tr>
<tr>
<td><code>data.email</code></td>
<td><strong>String</strong></td>
<td>The email address registered</td>
</tr>
<tr>
<td><code>data.belongsTo</code></td>
<td><strong>[Object]</strong></td>
<td>An array of organisations that the user belongs to containing a <code>domain</code> and <code>domainId</code> key</td>
</tr>
<tr>
<td><code>data.integrations</code></td>
<td><strong>[Object]</strong></td>
<td>An array of services/integrations that the user is able to access or has enabled. This lists out the ....</td>
</tr>
</tbody>
</table>
<h2 id="activation">Activation</h2>
<aside class="endpoint">
        <code>POST</code> /activate
</aside>

<p>The <strong>activate</strong> endpoint will allow users to activate their account after registration. This is <em><strong>required</strong></em> to gain access to the Edumaps API and Application.</p>
<aside class="warning text">Note: This endpoint url is dynamic and almost always generated by the API. You should not have a need for this endpoint</aside>

<blockquote>
<h3 id="-code-class-response-curl-code-request"><code class="response">CURL</code> Request</h3>
</blockquote>
<pre class="highlight bash"><code>curl -X GET &lt;-- endpoint here --&gt;/activate?token=&lt;-- token here --&gt;
</code></pre>
<blockquote>
<p>Remember to replace <code>&lt;-- token here --&gt;</code> with your own token</p>
</blockquote>
<aside class="request">Request</aside>

<h3 id="query-options">Query Options</h3>
<table>
<thead>
<tr>
<th></th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>token</code></td>
<td><code class="required"></code></td>
<td>Required to activate the user account. This will be found in the activation email</td>
</tr>
<tr>
<td><code>redirect</code></td>
<td></td>
<td>If provided the acivation will redirect to the page upon success otherwise a JSON of the user object is outputted instead</td>
</tr>
</tbody>
</table>
<blockquote>
<h3 id="-code-class-response-201-code-response"><code class="response">201</code> Response</h3>
</blockquote>
<pre class="highlight json"><code>{
        <span class="hljs-attr">"_id"</span>: <span class="hljs-string">"&lt;-- user id --&gt;"</span>,
        <span class="hljs-attr">"username"</span>: <span class="hljs-string">"&lt;-- user email address --&gt;"</span>,
        <span class="hljs-attr">"email"</span>: <span class="hljs-string">"&lt;-- user email address --&gt;"</span>,
        <span class="hljs-attr">"updatedAt"</span>: <span class="hljs-string">"2016-08-05T08:18:51.612Z"</span>,
        <span class="hljs-attr">"createdAt"</span>: <span class="hljs-string">"2016-08-05T08:18:51.612Z"</span>,
        <span class="hljs-attr">"belongsTo"</span>: [... &lt;-- array of organisation domains that user is associated to --&gt;],
        <span class="hljs-attr">"integrations"</span>: [... &lt;-- array of services that user has enabled --&gt;]
        ...
}
</code></pre>
<blockquote>
<p>Above is the output for a successful user activation if no redirect parameter is provided</p>
</blockquote>
<aside class="response">Response</aside>

<p>A JSON is outputted or a redirect happens depending on the passed in parameters within the URL GET request</p>
<h2 id="login">Login</h2>
<aside class="endpoint">
        <code>POST</code> /auth/login
</aside>

<p>Use this endpoint to log in a user.</p>
<blockquote>
<h3 id="-code-class-response-curl-code-request"><code class="response">CURL</code> Request</h3>
</blockquote>
<pre class="highlight bash"><code><span class="hljs-comment"># This is the call to authenticate a user</span>
curl <span class="hljs-string">"&lt;-- endpoint here --&gt;/auth/local"</span>
        -H <span class="hljs-string">"Accept: application/json"</span>
        -H <span class="hljs-string">"Content-Type: application/json"</span>
        <span class="hljs-_">-d</span> <span class="hljs-string">"email: &lt;-- user's email address --&gt;"</span>
        <span class="hljs-_">-d</span> <span class="hljs-string">"password: &lt;-- user's password --&gt;"</span>
</code></pre>
<aside class="request">Request</aside>

<p>You must pass in the request body <strong><code>email</code></strong> and <strong><code>password</code></strong>.</p>
<h3 id="payload-options">Payload Options</h3>
<table>
<thead>
<tr>
<th></th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>email</code></td>
<td><code class="required"></code></td>
<td>Registered user&#39;s email address</td>
</tr>
<tr>
<td><code>password</code></td>
<td><code class="required"></code></td>
<td>Registered user&#39;s password</td>
</tr>
</tbody>
</table>
<blockquote>
<h3 id="-code-class-response-201-code-response"><code class="response">201</code> Response</h3>
</blockquote>
<pre class="highlight json"><code>
{
        <span class="hljs-attr">"token"</span>: <span class="hljs-string">"&lt;-- jwt hashed token --&gt;"</span>,
        <span class="hljs-attr">"data"</span>: {
                <span class="hljs-attr">"_id"</span>: <span class="hljs-string">"&lt;-- user id --&gt;"</span>,
                <span class="hljs-attr">"username"</span>: <span class="hljs-string">"&lt;-- user email address --&gt;"</span>,
                <span class="hljs-attr">"email"</span>: <span class="hljs-string">"&lt;-- user email address --&gt;"</span>,
                <span class="hljs-attr">"updatedAt"</span>: <span class="hljs-string">"2016-08-05T08:18:51.612Z"</span>,
                <span class="hljs-attr">"createdAt"</span>: <span class="hljs-string">"2016-08-05T08:18:51.612Z"</span>,
                <span class="hljs-attr">"belongsTo"</span>: [... &lt;-- array of organisation domains that user is associated to --&gt;],
                <span class="hljs-attr">"integrations"</span>: [... &lt;-- array of services that user has enabled --&gt;]
                ...
        }
}
</code></pre>
<blockquote>
<p>Above is the typical response you will get after a successful user authentication. Please note that the response may contain more data properties than what is shown and the user must have activated their account first</p>
<h3 id="-code-class-response-401-code-response"><code class="response">401</code> Response</h3>
</blockquote>
<pre class="highlight json"><code>{
        <span class="hljs-attr">"name"</span>: <span class="hljs-string">"NotAuthenticated"</span>,
        <span class="hljs-attr">"message"</span>: <span class="hljs-string">"Not Activated"</span>,
        <span class="hljs-attr">"code"</span>: <span class="hljs-number">401</span>,
        <span class="hljs-attr">"className"</span>: <span class="hljs-string">"not-authenticated"</span>,
        <span class="hljs-attr">"errors"</span>: {}
}
</code></pre>
<aside class="response">Response</aside>

<table>
<thead>
<tr>
<th></th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>token</code></td>
<td><strong>String</strong></td>
<td>The authenticated login token returned that can be used for all subsequent calls</td>
</tr>
<tr>
<td><code>data._id</code></td>
<td><strong>String</strong></td>
<td>The ID of the newly registered user</td>
</tr>
<tr>
<td><code>data.username</code></td>
<td><strong>String</strong></td>
<td>The username of the user. <strong>This is currently automatically assigned the email address</strong></td>
</tr>
<tr>
<td><code>data.email</code></td>
<td><strong>String</strong></td>
<td>The email address registered</td>
</tr>
<tr>
<td><code>data.belongsTo</code></td>
<td><strong>[Object]</strong></td>
<td>An array of organisations that the user belongs to containing a <code>domain</code> and <code>domainId</code> key</td>
</tr>
<tr>
<td><code>data.integrations</code></td>
<td><strong>[Object]</strong></td>
<td>An array of services/integrations that the user is able to access or has enabled. This lists out the ....</td>
</tr>
</tbody>
</table>
<aside class="info">The above properties are just some of the properties that may be returned. Call the API endpoint to find and investigate the remaning properties that get returned</aside>

<h2 id="token">Token</h2>
<aside class="endpoint">
        <code>POST</code> /auth/token
</aside>

<p>Edumaps API allows for token based access in order for users to allow third-party apps to log in and access the user data. This is not to be confused with oAuth permissions. It is also a means to re-authenticating and retriving the current user data of the user if this has been mutated in anyway since their last login. This endpoint can be used as a means to bypass requring the user to enter their credentials everytime.</p>
<blockquote>
<h3 id="-code-class-response-curl-code-request"><code class="response">CURL</code> Request</h3>
</blockquote>
<pre class="highlight bash"><code>        <span class="hljs-comment"># This is the call to re-authenticate a user using a previous authenticated token</span>

        curl <span class="hljs-string">"&lt;-- endpoint here --&gt;/auth/local"</span>
                -H <span class="hljs-string">"Accept: application/json"</span>
                -H <span class="hljs-string">"Content-Type: application/json"</span>
                -H <span class="hljs-string">"Authorisation: &lt;-- jwt token --&gt;"</span>
</code></pre>
<aside class="request">Request</aside>

<h3 id="header-options">Header Options</h3>
<table>
<thead>
<tr>
<th></th>
<th>Required</th>
<th>Expected Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Authorisation</code></td>
<td><code class="required"></code></td>
<td>a jwt token</td>
<td>a valid jwt token must be passed and this can be obtained from the fist time user login - see <a href="#login">login</a> for details</td>
</tr>
</tbody>
</table>
<blockquote>
<h3 id="-code-class-response-201-code-response"><code class="response">201</code> Response</h3>
</blockquote>
<pre class="highlight json"><code>
{
        <span class="hljs-attr">"token"</span>: <span class="hljs-string">"&lt;-- jwt hashed token --&gt;"</span>,
        <span class="hljs-attr">"data"</span>: {
                <span class="hljs-attr">"_id"</span>: <span class="hljs-string">"&lt;-- user id --&gt;"</span>,
                <span class="hljs-attr">"username"</span>: <span class="hljs-string">"&lt;-- user email address --&gt;"</span>,
                <span class="hljs-attr">"email"</span>: <span class="hljs-string">"&lt;-- user email address --&gt;"</span>,
                <span class="hljs-attr">"updatedAt"</span>: <span class="hljs-string">"2016-08-05T08:18:51.612Z"</span>,
                <span class="hljs-attr">"createdAt"</span>: <span class="hljs-string">"2016-08-05T08:18:51.612Z"</span>,
                <span class="hljs-attr">"belongsTo"</span>: [... &lt;-- array of organisation domains that user is associated to --&gt;],
                <span class="hljs-attr">"integrations"</span>: [... &lt;-- array of services that user has enabled --&gt;]
                ...
        }
}
</code></pre>
<blockquote>
<p>Above is the typical response you will get after a successful user authentication. Please note that the response may contain more data properties than what is shown and the user must have activated their account first</p>
<h3 id="-code-class-response-401-code-response"><code class="response">401</code> Response</h3>
</blockquote>
<pre class="highlight json"><code>{
        <span class="hljs-attr">"name"</span>: <span class="hljs-string">"NotAuthenticated"</span>,
        <span class="hljs-attr">"message"</span>: <span class="hljs-string">"Not Activated"</span>,
        <span class="hljs-attr">"code"</span>: <span class="hljs-number">401</span>,
        <span class="hljs-attr">"className"</span>: <span class="hljs-string">"not-authenticated"</span>,
        <span class="hljs-attr">"errors"</span>: {}
}
</code></pre>
<aside class="response">Response</aside>

<table>
<thead>
<tr>
<th></th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>token</code></td>
<td><strong>String</strong></td>
<td>The authenticated login token returned that can be used for all subsequent calls</td>
</tr>
<tr>
<td><code>data._id</code></td>
<td><strong>String</strong></td>
<td>The ID of the newly registered user</td>
</tr>
<tr>
<td><code>data.username</code></td>
<td><strong>String</strong></td>
<td>The username of the user. <strong>This is currently automatically assigned the email address</strong></td>
</tr>
<tr>
<td><code>data.email</code></td>
<td><strong>String</strong></td>
<td>The email address registered</td>
</tr>
<tr>
<td><code>data.belongsTo</code></td>
<td><strong>[Object]</strong></td>
<td>An array of organisations that the user belongs to containing a <code>domain</code> and <code>domainId</code> key</td>
</tr>
<tr>
<td><code>data.integrations</code></td>
<td><strong>[Object]</strong></td>
<td>An array of services/integrations that the user is able to access or has enabled. This lists out the ....</td>
</tr>
</tbody>
</table>
<aside class="info">The above properties are just some of the properties that may be returned. Call the API endpoint to find and investigate the remaning properties that get returned</aside>


<h1 id="institution">Institution</h1>
<p>Currently, this endpoint is limited. It only allows internal calls to take place and creates a new organisation or returns an organisation based from user registration</p>
<h2 id="create">Create</h2>
<aside class="endpoint">
        <code>POST</code> /institution
</aside>

<p>Use this endpoint to create a new organisation. If the organisation already exists it is simply returned.</p>
<blockquote>
<h3 id="-code-class-response-curl-code-request"><code class="response">CURL</code> Request</h3>
</blockquote>
<pre class="highlight bash"><code><span class="hljs-comment"># This is the call to authenticate a user</span>
curl -X POST <span class="hljs-string">"&lt;-- endpoint here --&gt;/institution"</span>
        -H <span class="hljs-string">"Accept: application/json"</span>
        -H <span class="hljs-string">"Content-Type: application/json"</span>
        <span class="hljs-_">-d</span> <span class="hljs-string">"email: &lt;-- user's email address --&gt;"</span>
        <span class="hljs-_">-d</span> <span class="hljs-string">"domain: &lt;-- domain from user's email address --&gt;"</span>
</code></pre>
<aside class="request">Request</aside>

<p>You must pass in the request body an <strong><code>email</code></strong> or a <strong><code>domain</code></strong>.</p>
<h3 id="payload-options">Payload Options</h3>
<table>
<thead>
<tr>
<th></th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>email</code> or <code>domain</code></td>
<td><code class="required"></code></td>
<td>User&#39;s email address or a domain name</td>
</tr>
</tbody>
</table>
<blockquote>
<h3 id="-code-class-response-201-code-response"><code class="response">201</code> Response</h3>
</blockquote>
<pre class="highlight json"><code>
{
                <span class="hljs-attr">"_id"</span>: <span class="hljs-string">"&lt;-- organisation id --&gt;"</span>,
                <span class="hljs-attr">"domain"</span>: <span class="hljs-string">"&lt;-- organisation unique domain name --&gt;"</span>,
                <span class="hljs-attr">"updatedAt"</span>: <span class="hljs-string">"2016-08-05T08:18:51.612Z"</span>,
                <span class="hljs-attr">"createdAt"</span>: <span class="hljs-string">"2016-08-05T08:18:51.612Z"</span>
}
</code></pre>
<aside class="response">Response</aside>

<table>
<thead>
<tr>
<th></th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>_id</code></td>
<td><strong>String</strong></td>
<td>The ID of the newly created or returned organisation</td>
</tr>
<tr>
<td><code>domain</code></td>
<td><strong>String</strong></td>
<td>The domain extracted from the email address or passed in via <code>domain</code> is now the unique reference of the new organisation</td>
</tr>
</tbody>
</table>
<h1 id="errors">Errors</h1>
<blockquote>
<p>Below is the typical structure of a JSON error response</p>
</blockquote>
<pre class="highlight json"><code>{
        <span class="hljs-attr">"name"</span>: <span class="hljs-string">"NotFound"</span>,
        <span class="hljs-attr">"message"</span>: <span class="hljs-string">"Not Found"</span>,
        <span class="hljs-attr">"code"</span>: <span class="hljs-number">404</span>,
        <span class="hljs-attr">"className"</span>: <span class="hljs-string">"not-found"</span>,
        <span class="hljs-attr">"errors"</span>: {}
}
</code></pre>
<p>The Edumaps API uses the following error codes:</p>
<table>
<thead>
<tr>
<th>Error Code</th>
<th>Error Message</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td>400</td>
<td>Bad Request</td>
<td>...</td>
</tr>
<tr>
<td>401</td>
<td>Unauthorized</td>
<td>...</td>
</tr>
<tr>
<td>403</td>
<td>Forbidden</td>
<td>...</td>
</tr>
<tr>
<td>404</td>
<td>Not Found</td>
<td>...</td>
</tr>
<tr>
<td>405</td>
<td>Method Not Allowed</td>
<td>...</td>
</tr>
<tr>
<td>406</td>
<td>Not Acceptable</td>
<td>...</td>
</tr>
<tr>
<td>410</td>
<td>Gone</td>
<td>...</td>
</tr>
<tr>
<td>429</td>
<td>Too Many Requests</td>
<td>...</td>
</tr>
<tr>
<td>500</td>
<td>Internal Server Error</td>
<td>We had a problem with our server. Try again later.</td>
</tr>
<tr>
<td>503</td>
<td>Service Unavailable</td>
<td>We&#39;re temporarially offline for maintanance. Please try again later.</td>
</tr>
</tbody>
</table>
<h1 id="important-usage-notes">Important Usage Notes</h1>
<h2 id="authentication">Authentication</h2>
<h3 id="authentication">Authentication</h3>
<p>Edumaps&#39; users are grouped into organisations depending on their domain login (their registered email address). Therefore, to access and mutate particular datasets it is important to remember that after successful authentication every subsequent call after login that is requires an authenticated user must also request with a header property <code>Organisation</code> that is a JSON Web Token of what was recieved during the initial authentication process.</p>
<pre class="highlight bash"><code>curl <span class="hljs-string">"&lt;-- any endpoint that requires an authenticated user --&gt;"</span>
        -H <span class="hljs-string">"Accept: application/json"</span>
        -H <span class="hljs-string">"Content-Type: application/json"</span>
        -H <span class="hljs-string">"Authorisation: &lt;-- jwt token --&gt;"</span>
        -H <span class="hljs-string">"Organisation: &lt;-- jwt token --&gt;"</span>
</code></pre>
<blockquote>
<p>Please note that the <code>Authorisation</code> token is also still required</p>
</blockquote>

            </div>

            <div class="dark-box">
                <div class="lang-selector">
                        <a href="#" data-language-name="bash">bash</a>
                </div>
            </div>
        </div>
    </body>
</html>
